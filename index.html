<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>Ramadan Wallpaper Pro</title>
<style>
html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    background: #000;
    overflow: hidden;
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    color: white;
}
canvas {
    display: block;
}
</style>
</head>
<body>
<canvas id="wallpaper"></canvas>
<script>
const canvas = document.getElementById('wallpaper');
const ctx = canvas.getContext('2d');

function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);
resize();

// Рамадан
const startDate = new Date("2026-02-19");
const endDate = new Date("2026-03-21");
const totalDays = 30;

// Геолокация: Москва
const lat = 55.751244;
const lon = 37.618423;

// Цвета
const bgColor = "#000000";
const textColor = "#00e5d4";
const progressColor = "#00e5d4";

// Получаем время заката
async function getSunset() {
    const response = await fetch(`https://api.sunrise-sunset.org/json?lat=${lat}&lng=${lon}&formatted=0`);
    const data = await response.json();
    return new Date(data.results.sunset);
}

// Вычисляем текущий день Рамадана
async function getCurrentDay() {
    const now = new Date();
    const sunset = await getSunset();

    let today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
    let diff = Math.floor((today - startDate)/(1000*60*60*24)) + 1;

    if(now > sunset) diff += 1; // после заката переходим на следующий день
    if(diff < 1) diff = 1;
    if(diff > totalDays) diff = totalDays;

    return diff;
}

// Рисуем обои
async function drawWallpaper() {
    const day = await getCurrentDay();
    const now = new Date();
    const dateStr = now.toLocaleDateString("ru-RU", { day: 'numeric', month: 'long' });

    // фон
    ctx.fillStyle = bgColor;
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // RAMADAN
    ctx.fillStyle = "#666";
    ctx.font = `${Math.floor(canvas.height*0.03)}px sans-serif`;
    ctx.textAlign = "center";
    ctx.fillText("RAMADAN", canvas.width/2, canvas.height*0.15);

    // День
    ctx.fillStyle = textColor;
    ctx.font = `bold ${Math.floor(canvas.height*0.25)}px sans-serif`;
    ctx.fillText("День " + day, canvas.width/2, canvas.height*0.5);

    // Дата
    ctx.fillStyle = "#aaa";
    ctx.font = `${Math.floor(canvas.height*0.05)}px sans-serif`;
    ctx.fillText(dateStr, canvas.width/2, canvas.height*0.6);

    // Прогресс-бар
    const barWidth = canvas.width*0.7;
    const barHeight = canvas.height*0.02;
    const x = (canvas.width - barWidth)/2;
    const y = canvas.height*0.75;
    ctx.fillStyle = "#111";
    ctx.fillRect(x, y, barWidth, barHeight);
    ctx.fillStyle = progressColor;
    ctx.fillRect(x, y, (day/totalDays)*barWidth, barHeight);
}

// Первичная отрисовка
drawWallpaper();

// Автообновление каждые 10 минут
setInterval(drawWallpaper, 600000);
</script>
</body>
</html>
